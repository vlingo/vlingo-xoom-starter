<div class="model-aggregate">
  <app-step-title title="Model - Aggregate"></app-step-title>
  <div>
    <button mat-raised-button color="primary" (click)="openNewAggregateModal()">New Aggregate</button>
  </div>
  <div class="cards">
    <div class="aggregate" *ngFor="let aggregatesSetting of aggregateSettings; let i = index;">

      <mat-card class="api-card {{route.httpMethod}}" *ngFor="let route of aggregatesSetting.api.routes">
        <mat-card-header>
          <mat-card-title>{{route.httpMethod + ' -  /' + aggregatesSetting.api.rootPath + '/' +  route.path}}
          </mat-card-title>
        </mat-card-header>
      </mat-card>

      <mat-card class="aggregate-card">
        <mat-card-header>
          <mat-card-title>{{aggregatesSetting.aggregateName}}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-divider></mat-divider>
          <div class="parameters">
            <div *ngFor="let state of aggregatesSetting.stateFields">
              <span>{{state.name}}: {{state.type}}</span>
            </div>
          </div>
          <mat-divider></mat-divider>
          <div class="methods">
            <div *ngFor="let method of aggregatesSetting.methods">
              <span>{{method.name}}({{getMethodParameters(method, aggregatesSetting.stateFields)}})</span>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button (click)="remove(aggregatesSetting)">Remove</button>
          <button mat-button (click)="openAggregateModal(aggregatesSetting)">Edit</button>
          <button mat-button (click)="view(aggregatesSetting)">View</button>
        </mat-card-actions>

      </mat-card>
      <mat-card class="event-card" *ngFor="let event of aggregatesSetting.events">
        <mat-card-header>
          <mat-card-title>{{event.name}}</mat-card-title>
        </mat-card-header>
      </mat-card>

    </div>
  </div>
</div>
